<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <head>
        <title>Facelet Title</title>
    </head>
    <body>
        <ui:composition>
            <main>
                <div class="g-signin2" data-onsuccess="onSignIn"></div>
            </main>

            <form jsf:id="form">
                <input type="text" jsf:value="#{loginBean.id_token}" id="token" style="display:none" />
                <button jsf:action="#{loginBean.login()}" id="hiddenBtn" style="display:none">submit</button>
            </form>

            <script>
                function onSignIn(googleUser) {
                    // Useful data for your client-side scripts:
                    var profile = googleUser.getBasicProfile();
                    // The ID token you need to pass to your backend:
                    var id_token = googleUser.getAuthResponse().id_token;
                    document.getElementById('token').value = id_token;
                    document.getElementById('hiddenBtn').click();
                }
                ;
            </script>
        </ui:composition>
    </body>
</html>

